(this.webpackJsonpdndtome=this.webpackJsonpdndtome||[]).push([[17],{152:function(n,e,t){"use strict";t.d(e,"a",(function(){return r}));var r=function(){for(var n,e,t="",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<13;o++)t+=r[(n=0,e=r.length-1,Math.floor(Math.random()*(e-n+1))+n)];return t}},259:function(n,e){function t(n){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}t.keys=function(){return[]},t.resolve=t,n.exports=t,t.id=259},466:function(n,e,t){"use strict";var r,o=t(5),i=t(33),a=t(16),c=t(2),u=t(4),s=t(217),l=t.n(s),d=t(152),b=t(11),p=t(34),h=t(10),x=t(1);e.a=function(n){var e=n.encounter,t=n.isHost,r=n.onEdit,o=Object(c.useState)(""),u=Object(a.a)(o,2),s=u[0],h=u[1],j=Object(c.useState)(),g=Object(a.a)(j,2),O=g[0],m=g[1],v=Object(c.useState)(),w=Object(a.a)(v,2),y=w[0],k=w[1],C=Object(c.useState)([]),z=Object(a.a)(C,2),S=z[0],D=z[1],N=Object(c.useState)(!1),E=Object(a.a)(N,2),H=E[0],P=E[1];return Object(c.useEffect)((function(){if(void 0===O){var n=Object(d.a)(),t=new l.a(n,{host:"peerjs.thorbenkuck.de",secure:!0});t.on("connection",(function(n){D((function(e){return[].concat(Object(i.a)(e),[n])})),n.on("open",(function(){n.send(JSON.stringify(e))})),n.on("error",(function(n){k(n)})),n.on("data",(function(n){e!==n&&r(JSON.parse(n))})),n.on("close",(function(){D((function(e){return e.filter((function(e){return e!==n}))}))}))})),m(t)}}),[]),Object(c.useEffect)((function(){if(void 0!==O&&""!==s){var n=O.connect(s);n.on("open",(function(){D((function(e){return[].concat(Object(i.a)(e),[n])}))})),n.on("data",(function(n){e!==n&&(P(!0),r(JSON.parse(n)))})),n.on("close",(function(){D((function(e){return e.filter((function(e){return e!==n}))}))}))}}),[O,s,r]),Object(c.useEffect)((function(){e&&t&&S.forEach((function(n){n.send(JSON.stringify(e))}))}),[e,S,t]),Object(c.useEffect)((function(){!e||t||H?!t&&H&&P(!1):S.forEach((function(n){n.send(JSON.stringify(e))}))}),[e,S,t]),Object(x.jsxs)(x.Fragment,{children:[void 0!==O&&t&&Object(x.jsx)(p.a,{value:O.id,label:"Your ID:",onChange:function(){},style:{minWidth:"250px",float:"right"}}),void 0!==O&&!t&&Object(x.jsx)(p.a,{value:s,label:"ID to recive from",onChange:h,style:{minWidth:"250px",float:"right"}}),y&&Object(x.jsx)(f,{icon:b.x})]})};var f=Object(u.b)(h.a)(r||(r=Object(o.a)(["\n  margin-right: 5px;\n  width: 20px;\n  height: auto;\n  border-radius: 150px;\n  color: ",";\n"])),(function(n){return n.theme.main.highlight}))},467:function(n,e,t){"use strict";var r,o,i,a=t(5),c=(t(2),t(4)),u=t(1);e.a=function(n){var e=n.value,t=n.max,r=n.showMax,o=n.onChange;return Object(u.jsxs)(s,{children:[void 0!==t&&Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(l,{type:"number",max:t,value:e,onChange:function(n){return o(+n.target.value)}}),r&&Object(u.jsxs)(d,{children:["/ ",t]})]}),void 0===t&&Object(u.jsx)(l,{type:"number",value:e,onChange:function(n){return o(+n.target.value)}})]})};var s=c.b.label(r||(r=Object(a.a)(["\n  color: ",";\n  background-color: ",";\n  font-size: 16px;\n  overflow: hidden;\n  height: 30px;\n  line-height: 30px;\n  flex: 1 1 auto;\n  padding: 5px;\n  margin: 2px;\n  border-radius: 5px;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"])),(function(n){return n.theme.tile.color}),(function(n){return n.theme.tile.backgroundColor})),l=c.b.input(o||(o=Object(a.a)(["\n  flex: 1 1 auto;\n  max-width: 4em;\n  height: 30px;\n  padding: 5px;\n  box-sizing: border-box;\n  border: none;\n  background-color: ",";\n  color: ",";\n  margin-left: 5px;\n  border-radius: 5px;\n"])),(function(n){return n.theme.input.backgroundColor}),(function(n){return n.theme.input.color})),d=c.b.span(i||(i=Object(a.a)(["\n  margin-left: 5px;\n"])))},468:function(n,e,t){"use strict";var r,o,i,a,c,u,s,l,d,b,p=t(5),h=t(18),x=t(33),f=t(16),j=t(11),g=t(10),O=t(2),m=t(4),v=t(31),w=t(86),y=t(1);e.a=function(n){var e=n.isHost,t=n.img,r=n.players,o=n.showName,i=n.dimension,a=n.fogBoard,c=n.currentPlayerNumber,u=n.onChangePlayers,s=n.onChangeDimension,l=n.onChangeBoard,d=Object(O.useState)(),b=Object(f.a)(d,2),p=b[0],g=b[1],m=Object(O.useState)(),H=Object(f.a)(m,2),P=H[0],B=H[1],J=Object(O.useState)(a),M=Object(f.a)(J,2),F=M[0],I=M[1],R=Object(O.useState)(!1),V=Object(f.a)(R,2),L=V[0],U=V[1],W=Object(O.useCallback)((function(n){B(n)}),[]),G=Object(O.useCallback)((function(){return P}),[P]),T=Object(O.useCallback)((function(n){L&&(console.log("toggle fog"),I((function(e){var t=Object(x.a)(e);return t[n[0]][n[1]]=!t[n[0]][n[1]],t})))}),[I,L]),Y=Object(O.useCallback)((function(n){for(var t=[],s=0;s<i.width;s++)t.push(Object(y.jsx)(k,{isHost:e,cord:[n,s],showName:o,players:r,size:i.size,zoom:i.zoom/100,fog:!!(a&&a.length>=n&&a[n].length>=s)&&a[n][s],makeDrop:G,makeDrag:W,toggleFog:T,updatePlayers:u,currentPlayerNumber:c},"slot"+n+s));return t}),[i,r,o,u,c,G,W,e,a,T]),Z=Object(O.useCallback)((function(){for(var n=[],e=0;e<i.height;e++)n.push(Object(y.jsx)(E,{children:Y(e)},e));g(n)}),[i,Y]);Object(O.useEffect)((function(){console.time("Redo Board"),Z(),console.timeEnd("Redo Board")}),[t,i,r,G,e,L,F]);var _=Object(O.useCallback)((function(){U((function(n){return!n})),L&&(console.log("push board"),l(a))}),[L,a,l]);return Object(y.jsxs)(C,{children:[e&&Object(y.jsxs)(N,{children:[Object(y.jsx)(w.a,{value:i.zoom,label:"Zoom",step:10,onChange:function(n){return s(Object(h.a)(Object(h.a)({},i),{},{zoom:n}))}}),Object(y.jsx)(w.a,{value:i.width,label:"Horizontal",onChange:function(n){return s(Object(h.a)(Object(h.a)({},i),{},{width:n}))}}),Object(y.jsx)(w.a,{value:i.height,label:"Vertical",onChange:function(n){return s(Object(h.a)(Object(h.a)({},i),{},{height:n}))}}),Object(y.jsx)(w.a,{value:i.size,label:"Size",onChange:function(n){return s(Object(h.a)(Object(h.a)({},i),{},{size:n}))}}),Object(y.jsx)(v.a,{onClick:_,toggle:L,icon:j.G})]}),Object(y.jsxs)(z,{children:[Object(y.jsx)(S,{children:p}),Object(y.jsx)(D,{zoom:i.zoom/100,src:t})]})]})};var k=function(n){var e=n.isHost,t=n.size,r=n.zoom,o=n.cord,i=n.showName,a=n.players,c=(n.fog,n.currentPlayerNumber),u=n.makeDrop,s=n.makeDrag,l=n.toggleFog,d=n.updatePlayers,b=function(n,e){console.log("drag",e.name,e.cord),s(e)},p=function(n){n.preventDefault()},x=Object(O.useCallback)((function(n,e){if(e.isMonster)switch(e.size){case"gargantuan":return 4*n*r;case"huge":return 3*n*r;case"large":return 2*n*r}return n*r}),[r]);return Object(y.jsx)(H,{size:t*r,fog:!1,onDrop:function(n){return function(n,e){n.preventDefault();var t=u(),r=a.map((function(n){return n===t?Object(h.a)(Object(h.a)({},n),{},{cord:e}):n}));console.log("update Players"),d(r)}(n,o)},isHost:e,onDragOver:p,onClick:function(){return l(o)},children:a.filter((function(n){return!n.isVisible||e})).map((function(n,r){return void 0===n.cord&&0===o[0]&&0===o[1]||void 0!==n.cord&&n.cord[0]===o[0]&&n.cord[1]===o[1]?Object(y.jsx)(P,{index:r,drag:b,player:n,isHost:e,showName:i,dragOver:p,pic:n.pic,size:x(t,n),isDead:n.currentHp<=0,isCurrent:c===r},"icon"+r):Object(y.jsx)(M,{},"icon"+r)}))})},C=m.b.div(r||(r=Object(p.a)(["\n  flex: 1 1 min-content;\n  padding: 5px;\n  margin: 5px;\n  // position: relative;\n  max-width: calc(100vw - 120px);\n\n  @media (max-width: 576px) {\n    max-width: 100vw;\n  }\n\n  display: flex;\n  flex-wrap: wrap;\n"]))),z=m.b.div(o||(o=Object(p.a)(["\n  flex: 1 1 100%;\n  position: relative;\n\n  max-width: calc(100% - 10px);\n\n  overflow: scroll;\n\n  display: flex;\n  flex-wrap: wrap;\n"]))),S=m.b.div(i||(i=Object(p.a)(["\n  position: absolute;\n\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: flex-start;\n  align-items: flex-start;\n  align-content: flex-start;\n"]))),D=m.b.img(a||(a=Object(p.a)(["\n  width: calc(800px * ",");\n"])),(function(n){return n.zoom})),N=m.b.div(c||(c=Object(p.a)(["\n  flex: 1 1 100%;\n\n  height: 50px;\n  width: 100%;\n\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n"]))),E=m.b.div(u||(u=Object(p.a)(["\n  flex: 1 1 auto;\n  min-width: max-content;\n  display: flex;\n  flex-wrap: wrap;\n"]))),H=m.b.div(s||(s=Object(p.a)(["\n  flex: 1;\n  min-height: ","px;\n  min-width: ","px;\n  max-height: ","px;\n  max-width: ","px;\n\n  box-sizing: border-box;\n  border: 1px solid rgba(0, 0, 0, 0.3);\n  position: releativ;\n  ","\n"])),(function(n){return n.size}),(function(n){return n.size}),(function(n){return n.size}),(function(n){return n.size}),(function(n){var e=n.fog,t=n.isHost;return e?t?"background-color: rgba(0,0,0,0.5);":"background-color: rgba(0,0,0,1);":""})),P=function(n){var e=n.index,t=n.dragOver,r=n.drag,o=n.pic,i=n.size,a=n.showName,c=n.player,u=n.isDead,s=n.isCurrent,l=n.isHost;if(""!==o){var d={backgroundImage:"url(".concat(o,")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat",height:i-6+"px",width:i-6+"px",opacity:u?"0.5":"1",border:s?"":"none"};return Object(y.jsxs)(J,{onDragStart:function(n){return r(n,c)},onDragOver:t,draggable:!0,style:d,children:[l&&c.isMonster&&Object(y.jsx)(B,{children:e}),c.isVisible&&Object(y.jsx)(g.a,{icon:j.B,style:{color:"white"}})]})}var b={height:i-6+"px",width:i-6+"px",opacity:u?"0.5":"1",border:s?"":"none",padding:i/5+"px",fontSize:i/6+"px"};return Object(y.jsxs)(J,{onDragStart:function(n){return r(n,c)},onDragOver:t,draggable:!0,style:b,children:[c.isVisible&&Object(y.jsx)(g.a,{icon:j.B}),a?"".concat(c.name," ").concat(e):"??? ".concat(e)]})},B=m.b.div(l||(l=Object(p.a)(["\n  display: none;\n  position: absolute;\n  top: -35px;\n  left: 0;\n  right: 0;\n  text-align: center;\n  white-space: nowrap;\n  background-color: ",';\n  color: #fff;\n  border-radius: 10px;\n  padding: 5px;\n  transition: 0.3s;\n\n  &::after {\n    content: "";\n    position: absolute;\n    top: 100%;\n    left: 50%;\n    margin-left: -5px;\n    border-width: 5px;\n    border-style: solid;\n    border-color: '," transparent transparent transparent;\n  }\n"])),(function(n){return n.theme.main.highlight}),(function(n){return n.theme.main.highlight})),J=m.b.div(d||(d=Object(p.a)(["\n  margin: 3px;\n  float: left;\n  border-radius: 500px;\n  border: 3px solid ",";\n  box-shadow: 0px 0px 10px 0px rgba(172, 172, 172, 0.2);\n  background-color: white;\n  box-sizing: border-box;\n  cursor: move;\n  position: absolute;\n  text-align: center;\n\n  &:hover "," {\n    display: inline;\n  }\n"])),(function(n){return n.theme.main.highlight}),B),M=m.b.div(b||(b=Object(p.a)([""])))},622:function(n,e,t){"use strict";t.r(e);var r,o,i,a,c,u,s,l,d,b,p,h,x,f=t(5),j=t(18),g=t(33),O=t(16),m=t(2),v=t(3),w=t(4),y=t(467),k=t(468),C=t(466),z=t(1);e.default=function(){var n=Object(v.f)(),e=Object(m.useState)(),t=Object(O.a)(e,2),r=t[0],o=t[1],i=Object(m.useState)([]),a=Object(O.a)(i,2),c=a[0],u=a[1];Object(m.useEffect)((function(){void 0!==r&&u([].concat(Object(g.a)(r.players),Object(g.a)(r.enemies)))}),[r]);var s=Object(m.useCallback)((function(n){if(void 0!==r&&n!==(null===r||void 0===r?void 0:r.players)){var e=[];n.forEach((function(n){n.isEnemy||e.push(n)})),JSON.stringify(r.players)!==JSON.stringify(e)&&o(Object(j.a)(Object(j.a)({},r),{},{players:e}))}}),[r,o]),l=Object(m.useCallback)((function(){if(void 0!==r){if(""!==r.mapBase64&&null!==r.mapBase64&&void 0!==r.mapBase64)return r.mapBase64;if(""!==r.map&&null!==r.map&&void 0!==r.map)return r.map}return""}),[r]);return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(C.a,{encounter:r,onEdit:o,isHost:!1}),Object(z.jsxs)(N,{children:[Object(z.jsxs)(E,{mode:0,children:[Object(z.jsx)(H,{children:Object(z.jsx)("b",{children:null===r||void 0===r?void 0:r.name})}),Object(z.jsx)(R,{children:Object(z.jsxs)(J,{children:[Object(z.jsx)(F,{children:"Round: "}),null===r||void 0===r?void 0:r.roundCounter]})}),Object(z.jsxs)(D,{children:[Object(z.jsx)("thead",{children:Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{children:"Init"}),Object(z.jsx)("th",{children:"Name"})]})}),Object(z.jsx)("tbody",{children:r&&c.sort((function(n,e){return e.init!==n.init&&r.isPlaying?e.init-n.init:n.name.localeCompare(e.name)})).filter((function(n){return!n.isVisible})).map((function(e,t){return Object(z.jsxs)(P,{current:r.currentInit===t&&r.isPlaying,isDead:e.currentHp<=0,children:[Object(z.jsx)(M,{children:Object(z.jsx)(y.a,{value:e.init,onChange:function(){}})}),Object(z.jsxs)(B,{children:[""!==e.pic&&void 0!==e.pic?Object(z.jsx)(S,{player:e}):Object(z.jsx)(z.Fragment,{}),e.isMonster&&Object(z.jsx)(I,{children:"???"}),!e.isMonster&&Object(z.jsx)(I,{onClick:function(){return n.push("/char-detail/name/".concat(e.name))},children:e.name})]})]},t)}))})]})]}),r&&""!==l()&&Object(z.jsx)(k.a,{isHost:!1,onChangePlayers:s,players:c,showName:!1,dimension:void 0!==r.dimension?r.dimension:{width:20,height:20,size:20,zoom:100},fogBoard:r.board,currentPlayerNumber:r.currentInit,onChangeDimension:function(){},onChangeBoard:function(){},img:l()})]})]})};var S=function(n){var e=n.player;return Object(z.jsx)(V,{pic:e.pic})},D=w.b.table(r||(r=Object(f.a)(["\n  width: 100%;\n"]))),N=w.b.div(o||(o=Object(f.a)(["\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n"]))),E=w.b.div(i||(i=Object(f.a)(["\n  flex: 1 1;\n  color: ",";\n  font-size: 16px;\n  max-width: 800px;\n  ","\n  padding: 5px;\n\n  @media (max-width: 576px) {\n    min-width: 100%;\n  }\n"])),(function(n){return n.theme.tile.color}),(function(n){return n.mode?"min-width: 500px;":"min-width: 400px;"})),H=w.b.div(a||(a=Object(f.a)(["\n  height: auto;\n  float: left;\n  padding: 10px;\n  margin: 5px;\n  width: calc(100% - 30px);\n  color: var(--card-title-color);\n  text-align: center;\n  border-radius: 5px;\n  background-color: ",";\n"])),(function(n){return n.theme.tile.backgroundColor})),P=w.b.tr(c||(c=Object(f.a)(["\n  ","\n  margin: 2px;\n"])),(function(n){return n.isDead?"opacity: 0.5;":n.current?"td:nth-child(1) {background-color: ".concat(n.theme.main.highlight,";}"):""})),B=w.b.td(u||(u=Object(f.a)(["\n  margin: 2px;\n  padding: 5px;\n  border-radius: 5px;\n  background-color: ",";\n  line-height: 34px;\n"])),(function(n){return n.theme.tile.backgroundColor})),J=w.b.div(s||(s=Object(f.a)(["\n  margin: 5px;\n  padding: 10px;\n  height: 20px;\n  flex: 1 1 auto;\n  line-height: 20px;\n  border-radius: 5px;\n  background-color: ",";\n\n  svg {\n    margin-right: 5px;\n    height: auto;\n    border-radius: 150px;\n    transition: color 0.2s;\n    color: ",";\n  }\n"])),(function(n){return n.theme.tile.backgroundColor}),(function(n){return n.theme.main.highlight})),M=Object(w.b)(B)(l||(l=Object(f.a)(["\n  padding: 0px;\n"]))),F=w.b.span(d||(d=Object(f.a)(["\n  display: inline-block;\n  color: ",";\n  text-decoration: none;\n  margin: 0px 5px 0px 5px;\n"])),(function(n){return n.theme.tile.backgroundColorLink})),I=w.b.span(b||(b=Object(f.a)(["\n  display: inline-block;\n  background-color: ",";\n  border-radius: 5px;\n  text-decoration: none;\n  color: ",";\n  font-size: 16px;\n  padding: 0px 5px 0px 5px;\n  cursor: pointer;\n"])),(function(n){return n.theme.tile.backgroundColorLink}),(function(n){return n.theme.tile.backgroundColor})),R=w.b.div(p||(p=Object(f.a)(["\n  height: auto;\n  width: calc(100% - 6px);\n  float: left;\n  padding: 3px;\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-around;\n"]))),V=function(n){var e=n.pic,t={backgroundImage:"url(".concat(e,")"),backgroundPosition:"center",backgroundSize:"cover",backgroundRepeat:"no-repeat"};return""!==e?Object(z.jsx)(L,{style:t}):Object(z.jsx)(U,{})},L=w.b.div(h||(h=Object(f.a)(["\n  margin-right: 5px;\n  margin-top: -7px;\n  margin-bottom: -7px;\n  height: 43px;\n  width: 43px;\n  float: left;\n  border-radius: 100px;\n  border: 3px solid ",";\n  box-shadow: 0px 0px 10px 0px rgba(172, 172, 172, 0.2);\n  background-color: white;\n  overflow: hidden;\n\n  @media (max-width: 576px) {\n    display: none;\n  }\n"])),(function(n){return n.theme.main.highlight})),U=w.b.div(x||(x=Object(f.a)([""])))},86:function(n,e,t){"use strict";var r,o,i,a,c=t(5),u=(t(2),t(4)),s=t(10),l=t(1);e.a=function(n){var e=n.value,t=n.max,r=n.step,o=n.label,i=n.icon,a=n.transform,c=n.onChange;return Object(l.jsxs)(d,{children:[Object(l.jsxs)(p,{children:[i?Object(l.jsx)(b,{icon:i,transform:a}):""," ",o]}),t&&Object(l.jsx)(h,{type:"number",max:t,step:r||1,value:e,onChange:function(n){return c(+n.target.value)}}),!t&&Object(l.jsx)(h,{type:"number",step:r||1,value:e,onChange:function(n){return c(+n.target.value)}})]})};var d=u.b.label(r||(r=Object(c.a)(["\n  color: ",";\n  background-color: ",";\n  font-size: 16px;\n  overflow: hidden;\n  height: 38px;\n  line-height: 30px;\n  flex: 1 1 auto;\n  padding: 5px;\n  margin: 5px;\n  border-radius: 5px;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"])),(function(n){return n.theme.tile.color}),(function(n){return n.theme.tile.backgroundColor})),b=Object(u.b)(s.a)(o||(o=Object(c.a)(["\n  margin-right: 5px;\n  width: 20px;\n  height: auto;\n  border-radius: 150px;\n  transition: color 0.2s;\n  color: ",";\n"])),(function(n){return n.theme.main.highlight})),p=u.b.div(i||(i=Object(c.a)(["\n  flex: 1 1;\n"]))),h=u.b.input(a||(a=Object(c.a)(["\n  flex: 1 1 auto;\n  max-width: 6em;\n  height: 38px;\n  padding: 5px;\n  box-sizing: border-box;\n  border: none;\n  background-color: ",";\n  color: ",";\n  margin-left: 5px;\n  border-radius: 5px;\n"])),(function(n){return n.theme.input.backgroundColor}),(function(n){return n.theme.input.color}))}}]);
//# sourceMappingURL=17.7ebfa159.chunk.js.map